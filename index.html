<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Reservas Don Tasko</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { background-color:#121212; color:#fff; font-family:Arial; margin:0; padding:0; }
    .container { max-width:500px; margin:auto; padding:20px; }
    h1 { text-align:center; margin-bottom:20px; }
    label { display:block; margin-top:15px; margin-bottom:5px; }
    input, select, textarea, button {
      width:100%; padding:10px; margin-bottom:10px;
      border:none; border-radius:5px;
    }
    input, select, textarea { background-color:#1e1e1e; color:#fff; }
    button { background-color:#ff9800; color:#000; font-weight:bold; cursor:pointer; }
    button:hover { background-color:#e68900; }
    .admin-button { background-color:#4caf50; margin-top:20px; }
    .admin-button:hover { background-color:#43a047; }
    .mensagem { margin-top:10px; text-align:center; font-weight:bold; }
  </style>
</head>
<body>
  <div class="container">
<h1>Reservas Don Tasko</h1>

<label>Nome</label>
<input type="text" id="nome" placeholder="Seu nome">
<label>Email</label>
<input type="email" id="email" placeholder="seuemail@exemplo.com">
<label>Telefone</label>
<input type="text" id="telefone" placeholder="912345678">
<label>Data</label>
<input type="date" id="data" onchange="atualizarHorarios()">
<label>Hora</label>
<select id="hora"><option>Selecione uma data primeiro</option></select>
<label>Número de Pessoas</label>
<input type="number" id="pessoas" min="1" max="35">
<label>Observações</label>
<textarea id="obs" rows="3" placeholder="Observações adicionais"></textarea>

<button onclick="enviarReserva()">Reservar</button>
<button class="admin-button" onclick="acessarAdmin()">Área Administrativa</button>

<div class="mensagem" id="mensagem"></div>
</div>

<script>
function atualizarHorarios(){
  const data = document.getElementById('data').value;
  const horaSelect = document.getElementById('hora');
  horaSelect.innerHTML = "<option>Carregando...</option>";

  google.script.run.withSuccessHandler(function(horarios){
    if(horarios.length === 0){
      horaSelect.innerHTML = "<option>Restaurante fechado neste dia</option>";
    } else {
      horaSelect.innerHTML = "";
      horarios.forEach(h=>{
        const option = document.createElement("option");
        option.value = h.hora;
        option.text = `${h.hora} (${h.lugaresDisponiveis} lugares disponíveis)`;
        horaSelect.appendChild(option);
      });
    }
  }).getHorariosDisponiveis(data);
}

function enviarReserva(){
  const dados = {
    nome: document.getElementById('nome').value,
    email: document.getElementById('email').value,
    telefone: document.getElementById('telefone').value,
    data: document.getElementById('data').value,
    hora: document.getElementById('hora').value,
    pessoas: document.getElementById('pessoas').value,
    obs: document.getElementById('obs').value
  };
  google.script.run.withSuccessHandler(function(resposta){
    document.getElementById('mensagem').innerText = resposta;
  }).salvarReserva(dados);
}

function acessarAdmin(){
  const senha = prompt("Insira a senha de administrador:");
  google.script.run.withSuccessHandler(function(acesso){
    if(acesso){
      window.location.href = "?page=admin";
    } else {
      alert("Senha incorreta!");
    }
  }).verificarSenha(senha);
}
</script>
</body>
</html>